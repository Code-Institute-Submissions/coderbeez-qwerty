{% extends 'base.html' %}
{% block content%}

<!--HEADING-->
<div class="row">
      <div class="col-12 col-md-9 col-lg-6">
            <h1 class="d-inline-block">{{ language }} Notes </h1>
      </div>

      <!--<form class=""
      action="{{url_for('notes', language=language, )}}" method="POST">
      <input type="text" name="tsearch">
      <button type="submit" class="btn">search</button>
</form>-->

<form method="POST" action="">
            {{ form.hidden_tag() }}
            <!--WHY: form instance. hidden_tag method for security - will come back to later-->

            <fieldset class="form-group">
                {{ form.tsearch }} 
                {{ form.submit}}
                </fieldset>
                </form>





      <div class="col-12 col-md-3 col-lg-6 d-flex align-items-center justify-content-end justify-content-md-start">
            <a href="{{ url_for('addnote', language=language) }}">Add New <i class="fas fa-plus-circle"></i></a>
      </div>
</div>

{% for group_topic in group_topics %}
<!--WHAT: LEVEL 1 COLLAPSE - TOPIC-->
<h2><button class="btn angle" type="button" data-toggle="collapse" data-target="#id{{group_topic._id}}" aria-expanded="false"
            aria-controls="collapsePoints">
            <i class="fas fa-angle-double-down"></i>
      </button>{{ group_topic._id}}</h2>

<!--WHY: Content want to collapse wrapped in div.-->
<div id="id{{ group_topic._id}}" class="collapse">
      {% for note in notes %}
      {% if note.topic == group_topic._id %}

      <!--WHAT: LEVEL 2 COLLAPSE - NOTE NAME-->
      <p class="m-1 borders-top">
            <button class="btn angle" type="button" data-toggle="collapse" data-target="#id{{note._id}}" aria-expanded="false"
                  aria-controls="collapsePoints">
                  <i class="fas fa-angle-down"></i>
            </button>
            {{ note.note_name }}</p>
      <div class="collapse" id="id{{note._id}}">

            <textarea readonly class="form-control" rows=4>{{note.content}}</textarea>

            
            <a class="btn" href="{{url_for('editnote', language=language, noteid=note._id)}}">
            <span class="pt-2 mr-1">Edit</span><i class="fas fa-edit"></i></a>

            
            <button class="btn ml-5" type="button" data-toggle="collapse" data-target="#delete{{note._id}}"
                  aria-expanded="false" aria-controls="collapsePoints">
                  <span class="pt-2 mr-1">Delete</span><i class="fas fa-trash-alt"></i>
            </button>

            <!--DELETE COLLAPSE-->
            <div class="collapse" id="delete{{note._id}}">
                  <form action="{{url_for('deletenote', language=language, noteid=note._id)}}" method="POST">
                        <input type="submit" class="mt-3 btn button-style" value="I'm sure - delete this note">
                  </form>
            </div>
      </div>

      {% endif %}
      {% endfor %}
</div>

{% endfor %}

{% endblock content%}